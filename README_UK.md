# autopif

[English](./README.md) | **Українська** | [Русский](./README_RU.md)

Полегшений форк [daboynb/playcurl](https://github.com/daboynb/PlayIntegrityNEXT/tree/main/playcurl), який виконує одну задачу: кожні 25 хвилин завантажує файл [autojson/pif.json](https://github.com/daboynb/autojson/blob/main/pif.json) і порівнює його з вашим поточним файлом `custom.pif.json` або `pif.json`. Якщо ваш файл відрізняється або відсутній, він замінює його, зупиняє служби GMS/Wallet і очищує їх кеш. Якщо файли ідентичні або сталася помилка (наприклад, немає інтернет-з'єднання або не вдалося завантажити файл), він нічого не робить у цій ітерації (спробі). Цей модуль призначений для використання з модулем [osm0sis/PlayIntegrityFork](https://github.com/osm0sis/PlayIntegrityFork) (за моїм уподобанням) або з модулем [chiteroman/PlayIntegrityFix](https://github.com/chiteroman/PlayIntegrityFix).

Інтервал в 25 хвилин можна змінити, будь ласка, дивіться в розділах [Налаштування](#Налаштування) і [Примітка](#Примітка).

## Встановлення

1. Якщо модуль [osm0sis/PlayIntegrityFork](https://github.com/osm0sis/PlayIntegrityFork/releases/latest) або [chiteroman/PlayIntegrityFix](https://github.com/chiteroman/PlayIntegrityFix/releases/latest) ще не встановлений, встановіть його (перезавантажувати пристрій поки що не потрібно).

2. Встановіть цей модуль [autopif](https://github.com/vladrevers/autopif/releases/latest).

3. Перезавантажте пристрій. Якщо ви хочете побачити результати одразу, переконайтеся, що ваше інтернет-з'єднання увімкнене **перед** перезавантаженням.

## Налаштування

Ви можете знайти або створити такі файли для налаштування, в папці встановленого модуля autopif (`/data/adb/modules/autopif`) або всередині ZIP-файлу модуля перед встановленням:

- `minutes.txt` (містить лише ціле число, яке вказує інтервал у хвилинах для перевірки оновлень, за замовчуванням 25)
- `log_file_on` (якщо цей файл існує, лог буде записано у `/storage/emulated/0/autopif_log.txt`. Присутній за замовчуванням, видаліть цей файл, якщо вам лог не потрібен)
- `replace_log_file_on` (якщо цей файл існує, лог заміни вмісту PIF файлу (до/після) буде записуватися до `/storage/emulated/0/autopif_replace_log.txt`. За замовчуванням відсутній, створіть цей файл, якщо вам потрібне логування заміни вмісту)

## Ручний запуск

Ви можете виконати одноразову перевірку вручну, використовуючи наступну команду в терміналі:

```shell
cd /data/adb && ./magisk/busybox ash ./modules/autopif/service.sh -o
```

Ця команда запустить скрипт один раз з виведенням результатів у консоль. Це корисно для швидкого оновлення поточного PIF файлу та для відлагодження.

## Примітка

Після встановлення я рекомендую перевірити файл `autopif_log.txt` у внутрішньому сховищі через 12-24 години звичного використання пристрою. Я помітив, що на моєму пристрої з Android 14 скрипт призупиняється Magisk-ом або самим Android-ом, коли екран вимкнений протягом тривалого періоду, а інші додатки при цьому не виконують фонові завдання (наприклад, не грає музика). Скрипт автоматично продовжує роботу, після увімкнення екрану. Якщо у вас виникла подібна ситуація, можливо, варто зменшити інтервал перевірки з 25 хвилин до, наприклад, 20 хвилин. Проте залишити значення в 25 хвилин теж нормально. З іншого боку, якщо скрипт виконується точно за заданим інтервалом (наприклад, на старішій версії Android), можливо, варто збільшити інтервал з 25 хвилин до, наприклад, 45 хвилин. Встановлення занадто короткого інтервалу, особливо менш ніж 10 хвилин, не рекомендується, оскільки файл [autojson/pif.json](https://github.com/daboynb/autojson/blob/main/pif.json) на сервері оновлюється раз на годину. Після перевірки ви можете вимкнути логування і видалити файл журналу. Інструкції щодо зміни інтервалу перевірки та вимкнення логування дивіться у розділі [Налаштування](#Налаштування).